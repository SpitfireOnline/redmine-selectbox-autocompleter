<% type = Setting.plugin_selectbox_autocompleter['autocomplete_type'] %>
<%
  if type == 'select2'
%>
<script type="text/javascript">
  (function(){
    // select autocomplete plugin init

    function initSelectboxAutocompleter() {
      <%= raw generate_target_list_for_js %>.forEach(function (target) {
         var $selectbox = $('#' + target);
         if(!$selectbox.hasClass('select2-hidden-accessible') && $selectbox.is(':visible')) {
           $selectbox.select2();
         }
      });
    }

    var mo = new MutationObserver(initSelectboxAutocompleter);
    mo.observe(document.body, { attributes: true, childList: true, subtree: true });
  })();
</script>
<%
  end
%>
<%
  if type == 'datalist' || type == 'jquery'
%>
<script type="text/javascript">
  (function(){
    // select autocomplete plugin init

    function initSelectboxAutocompleter() {
      <%= raw generate_target_list_for_js %>.forEach(function(target) {selectboxAutocompleter.generateSelectboxAutocompleter(target, '<%= type %>')});
    }

    var mo = new MutationObserver(initSelectboxAutocompleter);
    mo.observe(document.body, { attributes: true, childList: true, subtree: true });
  })();
</script>
<%
  end
%>
